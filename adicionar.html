<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Produto</title>
    <link rel="stylesheet" href="css/adicionar.css">
</head>
<body>
    <header>
        <h1>Adicionar Produto</h1>
        <nav>
            <a href="index.html">Página Inicial</a>
            <a href="adicionar.html">Adicionar Produto</a>
            <a href="registro.html">Registrar Produção</a>
            <a href="produtos-registrados.html">Produtos Registrados</a>
            <a href="estoque.html">Acompanhamento de Estoque</a>
        </nav>
    </header>

    <div class="form-section">
        <h2>Cadastro de Produto</h2>
        <form id="form-produto">
            <div class="form-group">
                <label for="nome">Nome do Produto</label>
                <input type="text" id="nome" required>
            </div>

            <div class="form-group">
                <label for="peso">Peso do Pacote (kg)</label>
                <input type="number" id="peso" step="0.01" required>
            </div>

            <button type="submit">Adicionar Produto</button>
        </form>
    </div>

    <div class="produtos-lista">
        <h2>Produtos Cadastrados</h2>
        <table id="tabela-produtos">
            <thead>
                <tr>
                    <th>Nome do Produto</th>
                    <th>Peso do Pacote</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <!-- Os produtos cadastrados aparecerão aqui -->
            </tbody>
        </table>
    </div>

    <script>
        // Função para salvar o produto no localStorage
        function salvarProduto(nome, peso) {
            const produtos = JSON.parse(localStorage.getItem("produtos")) || [];
            produtos.push({ nome, peso });
            localStorage.setItem("produtos", JSON.stringify(produtos));
        }

        // Função para carregar os produtos cadastrados
        function carregarProdutos() {
            const produtos = JSON.parse(localStorage.getItem("produtos")) || [];
            const tabelaProdutos = document.getElementById('tabela-produtos').getElementsByTagName('tbody')[0];

            tabelaProdutos.innerHTML = ''; // Limpar a tabela antes de preencher

            produtos.forEach((produto, index) => {
                const row = tabelaProdutos.insertRow();
                row.insertCell(0).textContent = produto.nome;
                row.insertCell(1).textContent = produto.peso;
                const acoesCell = row.insertCell(2);
                
                // Botão Editar
                const editarBtn = document.createElement('button');
                editarBtn.textContent = 'Editar';
                editarBtn.classList.add('editar');
                editarBtn.onclick = () => editarProduto(index);
                acoesCell.appendChild(editarBtn);

                // Botão Excluir
                const excluirBtn = document.createElement('button');
                excluirBtn.textContent = 'Excluir';
                excluirBtn.classList.add('excluir');
                excluirBtn.onclick = () => excluirProduto(index);
                acoesCell.appendChild(excluirBtn);
            });
        }

        // Função para editar produto
        function editarProduto(index) {
            const produtos = JSON.parse(localStorage.getItem("produtos")) || [];
            const produto = produtos[index];

            document.getElementById('nome').value = produto.nome;
            document.getElementById('peso').value = produto.peso;

            // Substitui o botão de adicionar para um botão de salvar alterações
            const form = document.getElementById('form-produto');
            form.onsubmit = function(event) {
                event.preventDefault();
                produto.nome = document.getElementById('nome').value;
                produto.peso = document.getElementById('peso').value;

                produtos[index] = produto;
                localStorage.setItem("produtos", JSON.stringify(produtos));

                alert("Produto atualizado!");
                carregarProdutos(); // Atualiza a lista de produtos
            };
        }

        // Função para excluir produto
        function excluirProduto(index) {
            const produtos = JSON.parse(localStorage.getItem("produtos")) || [];
            produtos.splice(index, 1); // Remove o produto pelo índice
            localStorage.setItem("produtos", JSON.stringify(produtos));

            alert("Produto excluído!");
            carregarProdutos(); // Atualiza a lista de produtos
        }

        // Função para adicionar novo produto
        document.getElementById('form-produto').onsubmit = function(event) {
            event.preventDefault();

            const nome = document.getElementById('nome').value;
            const peso = document.getElementById('peso').value;

            if (!nome || !peso) {
                alert("Preencha todos os campos.");
                return;
            }

            salvarProduto(nome, peso);

            alert("Produto adicionado com sucesso!");
            carregarProdutos(); // Atualiza a lista de produtos
        };

        // Carregar os produtos cadastrados quando a página carregar
        window.onload = carregarProdutos;
    </script>
</body>
</html>
